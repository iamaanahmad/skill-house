
{
  "$id": "skillhouse",
  "name": "SkillHouse",
  "description": "Appwrite backend configuration for the SkillHouse application.",
  "region": "default",
  "collections": [
    {
      "$id": "profiles",
      "name": "Profiles",
      "documentSecurity": true,
      "permissions": [
        "read(\"any\")",
        "create(\"users\")",
        "update(\"user:{userId}\")",
        "delete(\"user:{userId}\")"
      ],
      "attributes": [
        {
          "key": "userId",
          "type": "string",
          "size": 255,
          "required": true,
          "description": "Related Appwrite User ID"
        },
        {
          "key": "name",
          "type": "string",
          "size": 255,
          "required": true
        },
        {
            "key": "username",
            "type": "string",
            "size": 100,
            "required": true
        },
        {
          "key": "avatarUrl",
          "type": "string",
          "size": 2048,
          "required": false,
          "default": ""
        },
        {
          "key": "bio",
          "type": "string",
          "size": 1000,
          "required": false,
          "default": ""
        },
        {
          "key": "socialLinks",
          "type": "string",
          "size": 2000,
          "required": false,
          "array": true,
          "default": []
        }
      ],
      "indexes": [
        {
          "key": "idx_userId",
          "type": "unique",
          "attributes": ["userId"]
        },
        {
            "key": "idx_username",
            "type": "unique",
            "attributes": ["username"]
        }
      ]
    },
    {
      "$id": "credentials",
      "name": "Credentials",
      "documentSecurity": true,
      "permissions": [
        "read(\"any\")",
        "create(\"users\")",
        "update(\"user:{userId}\")",
        "delete(\"user:{userId}\")"
      ],
      "attributes": [
        {
          "key": "userId",
          "type": "string",
          "size": 255,
          "required": true
        },
        {
          "key": "name",
          "type": "string",
          "size": 255,
          "required": true
        },
        {
          "key": "description",
          "type": "string",
          "size": 1000,
          "required": true
        },
        {
          "key": "icon",
          "type": "string",
          "size": 50,
          "required": true
        },
        {
          "key": "criteria",
          "type": "string",
          "size": 2000,
          "required": true
        },
        {
          "key": "evidence",
          "type": "string",
          "size": 2048,
          "required": true,
          "description": "URL to evidence (e.g., GitHub repo, project link)"
        },
        {
            "key": "level",
            "type": "string",
            "size": 50,
            "required": true,
            "elements": ["Beginner", "Intermediate", "Advanced"],
            "description": "Proficiency level"
        },
        {
            "key": "status",
            "type": "string",
            "size": 50,
            "required": true,
            "elements": ["pending", "verified", "rejected"],
            "default": "pending"
        },
        {
            "key": "endorsementCount",
            "type": "integer",
            "required": false,
            "default": 0
        },
        {
            "key": "isNft",
            "type": "boolean",
            "required": false,
            "default": false
        }
      ],
      "indexes": [
        {
          "key": "idx_userId",
          "type": "key",
          "attributes": ["userId"]
        },
        {
          "key": "idx_status",
          "type": "key",
          "attributes": ["status"]
        }
      ]
    },
    {
      "$id": "endorsements",
      "name": "Endorsements",
      "documentSecurity": true,
      "permissions": [
        "read(\"any\")",
        "create(\"users\")"
      ],
      "attributes": [
        {
          "key": "credentialId",
          "type": "string",
          "size": 255,
          "required": true
        },
        {
          "key": "endorserId",
          "type": "string",
          "size": 255,
          "required": true,
          "description": "User ID of the person giving the endorsement"
        }
      ],
      "indexes": [
        {
          "key": "idx_credentialId_endorserId",
          "type": "unique",
          "attributes": ["credentialId", "endorserId"]
        }
      ]
    },
    {
      "$id": "flagged_credentials",
      "name": "Flagged Credentials",
      "documentSecurity": true,
      "permissions": [
        "read(\"team:admin\")",
        "create(\"users\")",
        "update(\"team:admin\")",
        "delete(\"team:admin\")"
      ],
      "attributes": [
        {
            "key": "credentialId",
            "type": "string",
            "size": 255,
            "required": true
        },
        {
            "key": "reason",
            "type": "string",
            "size": 500,
            "required": true
        },
        {
            "key": "reporterId",
            "type": "string",
            "size": 255,
            "required": true,
            "description": "User ID of the person who flagged it"
        },
        {
            "key": "status",
            "type": "string",
            "size": 50,
            "required": true,
            "elements": ["open", "resolved", "dismissed"],
            "default": "open"
        }
      ],
      "indexes": [
        {
          "key": "idx_status",
          "type": "key",
          "attributes": ["status"]
        }
      ]
    }
  ],
  "storage": [
    {
      "$id": "user-avatars",
      "name": "User Avatars",
      "bucketSecurity": true,
      "fileSecurity": true,
      "permissions": [
        "read(\"any\")",
        "create(\"users\")",
        "update(\"user:{userId}\")",
        "delete(\"user:{userId}\")"
      ],
      "allowedFileExtensions": ["jpg", "jpeg", "png", "gif"],
      "maximumFileSize": 5000000
    },
    {
      "$id": "evidence-files",
      "name": "Evidence Files",
      "bucketSecurity": true,
      "fileSecurity": true,
      "permissions": [
        "create(\"users\")",
        "read(\"team:admin\")",
        "read(\"user:{userId}\")"
      ],
      "allowedFileExtensions": ["pdf", "zip", "jpg", "png", "mov", "mp4"],
      "maximumFileSize": 50000000,
      "description": "For direct file uploads as skill evidence."
    }
  ],
  "functions": [
    {
        "$id": "generateBadgeDescription",
        "name": "AI Badge Description Generator",
        "runtime": "node-18.0",
        "execute": ["any"],
        "entrypoint": "src/index.js",
        "events": [],
        "schedule": "",
        "timeout": 15,
        "variables": {
            "GEMINI_API_KEY": ""
        }
    }
  ]
}
